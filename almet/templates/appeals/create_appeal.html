{% extends 'base.html' %}

{% block title %}Подача обращения{% endblock %}

{% block content %}
<div class="row justify-content-center">
    <div class="col-md-6">
        <h2 class="text-center">Подача обращения</h2>
        <form method="post" enctype="multipart/form-data" class="needs-validation mt-4" novalidate>
            {% csrf_token %}

            {{ form.as_p }}

            <button type="submit" class="btn btn-primary">Отправить</button>
        </form>
    </div>
</div>

<script>
    // Функция для предпросмотра изображений
    function previewImages(event) {
        const fileList = document.getElementById('file-list');
        fileList.innerHTML = ''; // Очистить список при каждом новом выборе файлов

        const files = event.target.files;

        for (let i = 0; i < files.length; i++) {
            const reader = new FileReader();
            reader.onload = function(e) {
                const imgElement = document.createElement('img');
                imgElement.src = e.target.result;
                imgElement.style.width = '100px';
                imgElement.style.margin = '10px';
                fileList.appendChild(imgElement);
            }
            reader.readAsDataURL(files[i]);
        }
    }

    // Функция для обработки перетаскивания файлов
    const dropArea = document.getElementById('drop-area');
    dropArea.addEventListener('dragover', function(event) {
        event.preventDefault();
        dropArea.style.backgroundColor = '#f0f8ff'; // Изменение фона при перетаскивании
    });

    dropArea.addEventListener('dragleave', function(event) {
        dropArea.style.backgroundColor = ''; // Восстановление фона
    });

    dropArea.addEventListener('drop', function(event) {
        event.preventDefault();
        const files = event.dataTransfer.files;
        const input = document.getElementById('id_photos');
        input.files = files; // Добавление перетащенных файлов в поле ввода
        previewImages({ target: input }); // Обновление предпросмотра
    });
</script>

{% endblock %}

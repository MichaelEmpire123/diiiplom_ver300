{% extends 'base.html' %}
{% load static %}
{% block title %}Чат{% endblock %}

{% block content %}
<div class="container mt-4">
    <div class="chat d-flex flex-column gap-3">
        {% for message in messages %}
            {% if message.id_sitizen == user.id_citizen or message.id_sotrudnik == user.id_sotrudnik %}
                <div class="d-flex {% if message.id_sitizen %} align-items-start {% else %} justify-content-end {% endif %}">
                    <div class="message {% if message.id_sitizen %} bg-primary {% else %} bg-success {% endif %} text-white p-2 rounded w-50" style="font-size: 0.9rem;">
                        <div class="fw-bold">
                            {% if message.id_sitizen %}
                                {{ message.id_sitizen.surname }} {{ message.id_sitizen.name }}
                            {% else %}
                                {{ message.id_sotrudnik.surname }} {{ message.id_sotrudnik.name }}
                            {% endif %}
                        </div>
                        <p>{{ message.message }}</p>
                        <img src="https://via.placeholder.com/150" class="img-fluid mt-2" alt="Отправленное фото">
                    </div>
                </div>
            {% endif %}
        {% endfor %}
    </div>

    <form method="POST" class="input-group mt-3">
        {% csrf_token %}
        <input type="text" name="message" class="form-control" placeholder="Введите ваше сообщение">
        <label class="input-group-text" for="fileInput">
            <img src="{% static 'img/paperclip.svg' %}" alt="прикрепить фото">
        </label>
        <input type="file" class="d-none" id="fileInput" accept="image/*">
        <button type="submit" class="btn btn-primary">Отправить</button>
    </form>
</div>
{% endblock %}
